# Ch-04

## 面向对象编程

**Classes**

class 是对象的模板或蓝图。

Encapsulation （封装）是把数据（data）和行为（behavior）打包在一起，并对对象的用户隐藏实现细节。数据就是对象的 instance fields，操作数据的 procedures 被称为方法。

使封装工作的关键是让只有自己的方法可以直接访问 instance fields，因此只能通过对象的方法来操作数据。


**Objects**

对象的三个主要特性：


- 对象的行为
- 对象的状态
- 对象的标识

对象状态的改变一定要通过调用方法，否则是破环了封装。


**标识 classes**

一般名词（nouns）用来标识 class，动词（verbs）标识方法。


**类之间的关系**


- Dependence (“users-a”)
- Aggregation (“has-a”) 包含其他类，比如 Order 包含 Item
- Inheritance (“is-a”)




## 定义自己的类

```java
class Empoyee
{
    // instance fields
    private String name;
    private double salary;
    private LocalDate hireDay;
      
    // constructor
    public Employee(String n, double s, int year, int month, int day)
    {
        name = n;
        salary = s;
        hireDay = LocalDate.of(year, month, day);
    }
      
    // a method
    public String getName()
    {
        return name;
    }
    public double getSalary()
    {
        return salary;
    }

    public LocalDate getHireDay()
    {
        return hireDay;
    }
}
```

**Constructors**


- constructor 名称与类名相同
- 一个类可以有一个或多个 constructor
- constructor 接受零个或多个参数
- constructor 没有返回值
- constructor 必须使用 new 来调用

注意`constructor` 里的本地变量不能与 instance fields 同名


#### 隐式和显式参数

```java
public void raiseSalary(double byPercent)
{
    double raise = salary * byPercent / 100;
    salary += raise;
}
```

假设调用：
```java
number007.raiseSalary(5);
```

`raiseSalary` 则有两个参数，一个是在声明的括号里的 `byPercent` 参数，这是显式的；一个是出现在方法之前的 `Empolyee` 类型的对象，也就是 `number007`，这个是隐式的，不会出现在声明的参数列表里。

每个方法里都有 `this` 关键字来指向隐式的参数。比如：
```java
public void raiseSalary(double byPercent)
{
    double raise = this.salary * byPercent / 100;
    this.salary += raise;
}
```


#### 封装的益处

将 instance fields 都设置为 private，然后提供相应的 accessor, mutator 方法来读取或修改变量，可以获得更好的对变量的控制，而不是直接把 instance fields 设置成 public。

如果要获取和设置一个 instance fields 的值，则需要：
* private 的 data fields
* 一个 public 的 accessor 方法
* 一个 public 的 mutator 方法

这样的好处是如果 field 的数据类型改变了，只需要修改相应的 accessor 和 mutator 方法。

 accessor 方法不应该返回 mutable objects 的引用（references），这样外面的代码可以修改到这个引用的值，从而破坏了封装。因此最好使用 clone。

![](https://d2mxuefqeaa7sj.cloudfront.net/s_671ACDC6753147C1251D878A66070C67F33A653E05AA17A8EEBC3D888AE9FFF2_1536767789912_file.png)
```java
class Employee
{
    public Date getHireDay()
    {
        return (Date) hireDay.clone();
    }
}
```
<!--stackedit_data:
eyJoaXN0b3J5IjpbLTcwODU5MzcwMywtODQ2NTc5MDA3XX0=
-->